/media/ubuntu22/æ–°åŠ å·1/Projects/RemoteCLIP-main/remoteclip/lib/python3.11/site-packages/timm/models/registry.py:4: FutureWarning: Importing from timm.models.registry is deprecated, please import via timm.models
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.models", FutureWarning)
/media/ubuntu22/æ–°åŠ å·1/Projects/RemoteCLIP-main/remoteclip/lib/python3.11/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
ä½¿ç”¨è®¾å¤‡: cuda
åˆ›å»ºç®€åŒ–SurgeryCAMæ¨¡å‹...
Loading SimpleSurgeryCAM (no p2p, no AAF)...
ğŸ“¥ åŠ è½½æƒé‡: /media/ubuntu22/æ–°åŠ å·1/Projects/RemoteCLIP-main/checkpoints/RemoteCLIP-ViT-B-32.pt
ğŸ”§ ä½¿ç”¨Surgeryæ¶æ„ï¼ˆæœ‰VVæ³¨æ„åŠ›ï¼‰
âœ… æ¨¡å‹åŠ è½½æˆåŠŸ
âœ… CAMç”Ÿæˆå™¨çš„å¯å­¦ä¹ æŠ•å½±å±‚å·²è§£å†»
Trainable parameters: 920,564
âœ… å·²åŠ è½½checkpoint: checkpoints/best_simple_model.pth
   Epoch: 95
   Loss: 2.4584
   å·²åŠ è½½ 13 ä¸ªå¯è®­ç»ƒå‚æ•°
é™åˆ¶è¯„ä¼°æ ·æœ¬æ•°é‡: 100/11738

å¼€å§‹è¯„ä¼°...
è¯„ä¼°ä¸­:   0%|          | 0/13 [00:00<?, ?it/s]è¯„ä¼°ä¸­:   8%|â–Š         | 1/13 [00:01<00:19,  1.59s/it]è¯„ä¼°ä¸­:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:01<00:03,  2.94it/s]è¯„ä¼°ä¸­:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:01<00:01,  4.56it/s]è¯„ä¼°ä¸­:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:02<00:00,  5.91it/s]è¯„ä¼°ä¸­:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:02<00:00,  7.50it/s]è¯„ä¼°ä¸­:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:02<00:00,  9.15it/s]è¯„ä¼°ä¸­: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:02<00:00,  4.89it/s]
Traceback (most recent call last):
  File "/media/ubuntu22/æ–°åŠ å·1/Projects/RemoteCLIP-main/src/experiments/exp4/evaluate_simple_model.py", line 232, in <module>
    main()
  File "/media/ubuntu22/æ–°åŠ å·1/Projects/RemoteCLIP-main/src/experiments/exp4/evaluate_simple_model.py", line 194, in main
    seen_map = [map_results['per_class_ap'][i] for i in seen_indices]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/media/ubuntu22/æ–°åŠ å·1/Projects/RemoteCLIP-main/src/experiments/exp4/evaluate_simple_model.py", line 194, in <listcomp>
    seen_map = [map_results['per_class_ap'][i] for i in seen_indices]
                ~~~~~~~~~~~^^^^^^^^^^^^^^^^
KeyError: 'per_class_ap'
