Experiment 3: FINAL STATUS - Text-Guided Heatmaps with GT Boxes
================================================================

COMPLETED ✅
===========

1. CLIP Standard Prompt Format
   - Format: "an aerial photo of {class}"
   - Applied to all 20 DIOR classes
   - Used for text encoding in all modes

2. GT Box Filtering
   - Only show bboxes matching the text query class
   - Filter: bbox['class'] == target_class
   - Example: For "overpass", only show overpass boxes (not other objects)

3. Correct Bbox Scaling
   - Original: 800x800 pixels
   - Scaled: 224x224 pixels
   - Scale factor: 0.28 (224/800)

4. 5 Modes x 12 Layers Comparison
   Row 1: With Surgery
   Row 2: Without Surgery
   Row 3: With VV (placeholder)
   Row 4: Standard QKV (placeholder)
   Row 5: Complete Surgery (placeholder)

5. Image ID Display
   - Format: "Mode\nan aerial photo of class\nID: DIOR_xxxxx"
   - Enables verification against original images

FILTERED GT BOX COUNTS
=======================
Sample 0 (DIOR_03135, Expressway-toll-station): 1 box (filtered from 2)
Sample 1 (DIOR_05386, overpass): 1 box (filtered from 4)
Sample 2 (DIOR_08859, dam): 1 box (all 1 match)
Sample 3 (DIOR_09041, windmill): 11 boxes (all 11 match)
Sample 4 (DIOR_09115, windmill): 10 boxes (all 10 match)

GENERATED FILES
===============
comprehensive_comparison_results/ (5 files, ~70MB)
- comprehensive_comparison_sample0.png (14MB)
- comprehensive_comparison_sample1.png (14MB)
- comprehensive_comparison_sample2.png (13MB)
- comprehensive_comparison_sample3.png (15MB)
- comprehensive_comparison_sample4.png (14MB)

Each image: 5 rows × 13 columns = 65 subplots
- 5 modes × (1 original + 12 layer heatmaps)
- Green GT boxes only for matching class
- CLIP prompt shown in title

CODE CHANGES
============
comprehensive_comparison.py:
- Line 205-213: Create prompt format class names
- Line 40-94: Update generate_heatmaps_for_mode() signature
- Line 135-136: Show prompt in title
- Line 141-163: Filter bboxes by class
- Line 181-203: Filter bboxes on heatmaps

utils/seen_unseen_split.py:
- Line 189-200: Return original_size in __getitem__()

VERIFICATION
============
To verify correct GT boxes:
1. Open: comprehensive_comparison_results/comprehensive_comparison_sample*.png
2. Check: Green boxes only on target class objects
3. Read: Title shows "an aerial photo of {class}"
4. Compare: Against original DIOR images using Image ID

Example verification:
- DIOR_03135: Only toll station box (not other buildings)
- DIOR_05386: Only overpass box (not vehicles/buildings)
- DIOR_09041: All 11 windmills (all match query)

GIT COMMITS
===========
Latest: Fix CLIP prompt + filter GT boxes by class
Previous: Add GT box debug + Image ID display

RUNNING COMMANDS
================
cd /media/ubuntu22/新加卷1/Projects/RemoteCLIP-main

# Generate 5x13 comparison (with filtered GT boxes)
PYTHONPATH=. ovadetr_env/bin/python3.9 \
  experiment4/experiments/surgery_clip/exp3_text_guided_vvt/comprehensive_comparison.py \
  --dataset datasets/mini_dataset --max-samples 5

STATUS: READY FOR REVIEW
========================
All requested features implemented:
✅ GT boxes positioned correctly
✅ Only show boxes matching text query
✅ CLIP standard prompt format
✅ 5 modes as specified
✅ 12 layers complete
✅ No Chinese characters
✅ Image IDs for verification
