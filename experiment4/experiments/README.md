# Experiment 4 - å®éªŒç´¢å¼•

æœ¬ç›®å½•åŒ…å«Experiment 4çš„æ‰€æœ‰è¯Šæ–­å’Œä¼˜åŒ–å®éªŒã€‚

---

## ğŸ“ å®éªŒç›®å½•

### [01_baseline_heatmap](01_baseline_heatmap/) â­ **æœ€é‡è¦**

**ç›®çš„**ï¼šéªŒè¯Surgeryå»å†—ä½™æ˜¯å¦åœ¨çƒ­å›¾ç”Ÿæˆä¸­æ‰§è¡Œ  
**å‘ç°**ï¼šâŒ **CLIPSurgeryWrapperä»æœªæ‰§è¡ŒSurgeryå»å†—ä½™**  
**å½±å“**ï¼šä¿®æ­£æ‰€æœ‰ä¹‹å‰çš„é”™è¯¯ç»“è®º

**å…³é”®æˆæœ**ï¼š
- Surgeryé™ä½mAP 19%ï¼ˆ0.3818 â†’ 0.3091ï¼‰
- Surgery+åè½¬æå‡31%ï¼ˆ0.3818 â†’ **0.5000**ï¼‰â­
- **æœ€ä½³é…ç½®ï¼šSurgery+åè½¬+30%é˜ˆå€¼ â†’ mAP@0.05 = 0.5000**

**è¯¦æƒ…**ï¼šè§ [`01_baseline_heatmap/README.md`](01_baseline_heatmap/README.md)

---

### [02_threshold_fix](02_threshold_fix/)

**ç›®çš„**ï¼šä¿®å¤é˜ˆå€¼é€»è¾‘é”™è¯¯ï¼ˆå½’ä¸€åŒ–+é«˜ç™¾åˆ†ä½ï¼‰  
**å‘ç°**ï¼šé˜ˆå€¼30%æ˜¯ä¸´ç•Œç‚¹ï¼ˆå¯¹åº”ç›¸ä¼¼åº¦0.16ï¼ŒGTå¹³å‡0.17ï¼‰

**å…³é”®æˆæœ**ï¼š
- åŸå§‹å€¼ç™¾åˆ†ä½ï¼š+2.6%
- é™ä½é˜ˆå€¼åˆ°30%ï¼š+37.3%
- åè½¬+30%ï¼š+49.9%

**è¯¦æƒ…**ï¼šè§ [`02_threshold_fix/README.md`](02_threshold_fix/README.md)

---

### [03_feature_diagnosis](03_feature_diagnosis/)

**ç›®çš„**ï¼šè¯Šæ–­GTåŒºåŸŸå“åº”ä½å’ŒSurgeryå½±å“  
**å‘ç°**ï¼š60%æ ·æœ¬GT<èƒŒæ™¯ï¼ŒSurgeryæ‰©å¤§gap 108%

**å…³é”®æˆæœ**ï¼š
- GTå¹³å‡ç›¸ä¼¼åº¦ï¼š0.17 vs èƒŒæ™¯0.20ï¼ˆ-15%ï¼‰
- Surgeryä½¿gapä»-0.0263æ¶åŒ–åˆ°-0.0548
- 2/5æ ·æœ¬Surgeryåè½¬GT-èƒŒæ™¯å…³ç³»

**è¯¦æƒ…**ï¼šè§ [`03_feature_diagnosis/README.md`](03_feature_diagnosis/README.md)

---

## ğŸ“Š æ€§èƒ½æ±‡æ€»

### æœ€ç»ˆæ€§èƒ½å¯¹æ¯”

| é…ç½® | mAP@0.05 | mAP@0.50 | vsåŸå§‹ |
|------|----------|----------|--------|
| åŸå§‹(å½’ä¸€åŒ–+75%) | 0.2780 | 0.0000 | baseline |
| ä¿®å¤é˜ˆå€¼(åŸå§‹å€¼75%) | 0.2851 | 0.0000 | +2.6% |
| RemoteCLIP+30% | 0.3818 | 0.1667 | +37.3% |
| RemoteCLIP+åè½¬+30% | 0.4167 | 0.0833 | +49.9% |
| **Surgery+åè½¬+30%** â­ | **0.5000** | **0.1667** | **+79.9%** |

### æœ€ä½³é…ç½®

| åœºæ™¯ | é…ç½® | mAP@0.05 | mAP@0.50 |
|------|------|----------|----------|
| **æ£€æµ‹ï¼ˆå¬å›ä¼˜å…ˆï¼‰** | **Surgery+åè½¬+30%** | **0.5000** | 0.1667 |
| éªŒè¯ï¼ˆç²¾åº¦ä¼˜å…ˆï¼‰ | RemoteCLIP+30% | 0.3818 | 0.1667 |

---

## ğŸ” æ ¸å¿ƒå‘ç°æ€»ç»“

### å‘ç°1ï¼šSurgeryæœªåœ¨çƒ­å›¾ä¸­æ‰§è¡Œ

**è¯æ®**ï¼š
- CLIPSurgeryWrapperè¾“å‡º = åŸå§‹RemoteCLIPï¼ˆå·®å¼‚0.0ï¼‰
- SimplifiedDenoiseråªåœ¨è®­ç»ƒæ—¶ä½¿ç”¨
- çƒ­å›¾è¯„ä¼°å’Œè®­ç»ƒä½¿ç”¨äº†**ä¸åŒçš„ç‰¹å¾å¤„ç†æµç¨‹**

**å½±å“**ï¼š
- ä¹‹å‰æ‰€æœ‰"Surgery vs æ— Surgery"å¯¹æ¯”éƒ½æ˜¯é”™è¯¯çš„
- å®é™…ä¸Šéƒ½åœ¨ç”¨RemoteCLIPåŸå§‹ç‰¹å¾

### å‘ç°2ï¼šSurgeryçš„çœŸå®ä½œç”¨

**Surgeryå»å†—ä½™ï¼ˆF - mean(F)ï¼‰**ï¼š
- å•ç‹¬ä½¿ç”¨ï¼šmAP **ä¸‹é™19%**ï¼ˆæŠ‘åˆ¶GTï¼‰
- ç»“åˆåè½¬ï¼šmAP **æå‡31%**ï¼ˆä¿®æ­£æŠ‘åˆ¶ï¼‰
- **Surgery+åè½¬æ˜¯æœ€å¼ºç»„åˆ**

### å‘ç°3ï¼šé˜ˆå€¼çš„å…³é”®æ€§

**é˜ˆå€¼é€‰æ‹©**ï¼š
- 75%é˜ˆå€¼ï¼šå¯¹åº”0.22ï¼Œæ’é™¤GTï¼ˆå¹³å‡0.17ï¼‰
- 30%é˜ˆå€¼ï¼šå¯¹åº”0.16ï¼ŒåŒ…å«GT
- **30%æ˜¯ä¸´ç•Œç‚¹**ï¼ˆmAPä»0.28è·ƒå‡åˆ°0.38ï¼‰

---

## ğŸ¯ æŠ€æœ¯è´¡çŒ®

### 1. æ­ç¤ºSurgeryçš„çœŸç›¸

Surgeryä¸æ˜¯ç®€å•çš„"å»å†—ä½™"ï¼Œè€Œæ˜¯ï¼š
- **ä¸­å¿ƒåŒ–æ“ä½œ**ï¼šF - mean(F)
- **ä½œç”¨**ï¼šå»é™¤å…¬å…±ç‰¹å¾ï¼Œå¢å¼ºå·®å¼‚
- **å‰¯ä½œç”¨**ï¼šç›®æ ‡å¦‚æœæ˜¯"å…¬å…±çš„"ï¼Œä¼šè¢«æŠ‘åˆ¶ä¸ºè´Ÿå€¼
- **ä¿®æ­£**ï¼šåè½¬ç›¸ä¼¼åº¦ï¼ˆ-similarityï¼‰

### 2. å®šä½é˜ˆå€¼é—®é¢˜

**ä¸‰å±‚é—®é¢˜ç»“æ„**ï¼š
1. è¡¨è±¡ï¼šçƒ­å›¾é¢œè‰²åè½¬
2. ä¸­å±‚ï¼šé˜ˆå€¼75%å¤ªé«˜ï¼ˆ**è´¡çŒ®70%**ï¼‰
3. æ ¹æœ¬ï¼šSurgeryæŠ‘åˆ¶GTï¼ˆ**è´¡çŒ®30%**ï¼‰

### 3. æ‰¾åˆ°æœ€ä¼˜ç»„åˆ

**Surgery+åè½¬+30%**ï¼š
- mAP@0.05 = 0.5000ï¼ˆæå‡79.9%ï¼‰
- è¶…è¿‡æ‰€æœ‰å…¶ä»–é…ç½®

---

## ğŸ“ æ–‡ä»¶ç»„ç»‡

```
experiments/
â”œâ”€â”€ 01_baseline_heatmap/       # SurgeryéªŒè¯
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ verify_surgery.py
â”‚   â””â”€â”€ results/
â”œâ”€â”€ 02_threshold_fix/          # é˜ˆå€¼ä¿®å¤
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ test_low_threshold.py
â”‚   â””â”€â”€ outputs/
â”œâ”€â”€ 03_feature_diagnosis/      # ç‰¹å¾è¯Šæ–­
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ print_patch_grid.py
â”‚   â”œâ”€â”€ surgery_impact_analysis.py
â”‚   â””â”€â”€ outputs/
â”œâ”€â”€ ğŸ¯çƒ­å›¾ä¿®å¤å®éªŒ_æœ€ç»ˆæŠ¥å‘Š.md    # ç»¼åˆæŠ¥å‘Š
â”œâ”€â”€ ä¸€å¥è¯æ€»ç»“.txt
â””â”€â”€ README.md (æœ¬æ–‡æ¡£)
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

### ç«‹å³å¯åš

1. **åº”ç”¨æœ€ä½³é…ç½®**ï¼šä¿®æ”¹ä¸»è¯„ä¼°è„šæœ¬ä½¿ç”¨Surgery+åè½¬+30%
2. **åœ¨DIORå…¨é›†éªŒè¯**ï¼šæ‰©å±•åˆ°å®Œæ•´æ•°æ®é›†
3. **ç”Ÿæˆé«˜è´¨é‡å¯è§†åŒ–**ï¼šå±•ç¤ºä¿®å¤æ•ˆæœ

### ä¸­æœŸç›®æ ‡

1. **è®­ç»ƒæ¨¡å‹**ï¼šæå‡GTåŒºåŸŸç›¸ä¼¼åº¦ï¼ˆä»0.17åˆ°0.25+ï¼‰
2. **ä¼˜åŒ–Surgery**ï¼šä¿ç•™éƒ¨åˆ†å…¬å…±ç‰¹å¾ï¼Œå‡å°‘æŠ‘åˆ¶
3. **è‡ªé€‚åº”é˜ˆå€¼**ï¼šæ¯ä¸ªç±»åˆ«ç‹¬ç«‹è®¾ç½®

---

**é¡¹ç›®**ï¼šRemoteCLIP Experiment 4  
**å®Œæˆæ—¶é—´**ï¼š2025-10-29  
**æ€»å®éªŒæ•°**ï¼š7ç»„ï¼ˆ4è¯Šæ–­ + 3ä¿®å¤ï¼‰  
**æ ¸å¿ƒæˆæœ**ï¼šmAP@0.05æå‡79.9%ï¼ˆ0.278 â†’ 0.500ï¼‰

