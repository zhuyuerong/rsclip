# RemoteCLIP å®éªŒç»“æ„è¯´æ˜

## ğŸ“ å®Œæ•´çš„å®éªŒç»„ç»‡ç»“æ„

æ‰€æœ‰å®éªŒç›¸å…³æ–‡ä»¶å·²é›†ä¸­åœ¨ `experiment1/` æ–‡ä»¶å¤¹ä¸­ï¼š

```
experiment1/
â”œâ”€â”€ stage1/                  # Stage1: æ•°æ®é¢„å¤„ç†å’Œå€™é€‰æ¡†ç”Ÿæˆ
â”‚   â”œâ”€â”€ data_loader.py       # æ•°æ®åŠ è½½å™¨
â”‚   â”œâ”€â”€ demo_simple.py       # ç®€å•æ¼”ç¤ºè„šæœ¬
â”‚   â”œâ”€â”€ proposal_classifier.py # å€™é€‰æ¡†åˆ†ç±»å™¨
â”‚   â”œâ”€â”€ proposal_generator.py  # å€™é€‰æ¡†ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ region_sampler.py    # åŒºåŸŸé‡‡æ ·å™¨
â”‚   â”œâ”€â”€ retrieval.py         # æ£€ç´¢åŠŸèƒ½
â”‚   â”œâ”€â”€ sampling.py          # é‡‡æ ·ç­–ç•¥ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â””â”€â”€ visualize_regions.py # åŒºåŸŸå¯è§†åŒ–
â”‚
â”œâ”€â”€ stage2/                  # Stage2: ç›®æ ‡æ£€æµ‹å’Œä¼˜åŒ–
â”‚   â”œâ”€â”€ bbox_refinement.py   # è¾¹ç•Œæ¡†å¾®è°ƒï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”œâ”€â”€ bbox_refiner.py      # è¾¹ç•Œæ¡†å¾®è°ƒå™¨ï¼ˆå®éªŒç‰ˆï¼‰
â”‚   â”œâ”€â”€ proposal_scorer.py   # å€™é€‰æ¡†æ‰“åˆ†å™¨
â”‚   â”œâ”€â”€ target_detection.py  # ç›®æ ‡æ£€æµ‹ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”œâ”€â”€ target_detector.py   # ç›®æ ‡æ£€æµ‹å™¨ï¼ˆå®éªŒç‰ˆï¼‰
â”‚   â”œâ”€â”€ unseen_detection_pipeline.py # æœªè§ç›®æ ‡æ£€æµ‹æµæ°´çº¿
â”‚   â”œâ”€â”€ wordnet_enhancer.py  # WordNetå¢å¼ºå™¨ï¼ˆå®éªŒç‰ˆï¼‰
â”‚   â””â”€â”€ wordnet_vocabulary.py # WordNetè¯æ±‡è¡¨ï¼ˆæ ¸å¿ƒï¼‰
â”‚
â”œâ”€â”€ inference/               # æ¨ç†å¼•æ“
â”‚   â”œâ”€â”€ inference_engine.py  # æ¨ç†å¼•æ“ï¼ˆç»Ÿä¸€æ¥å£ï¼‰
â”‚   â”œâ”€â”€ model_loader.py      # æ¨¡å‹åŠ è½½å™¨
â”‚   â””â”€â”€ output_manager.py    # è¾“å‡ºç®¡ç†å™¨
â”‚
â”œâ”€â”€ scripts/                 # å®éªŒè„šæœ¬
â”‚   â””â”€â”€ experiments/         # å®éªŒæµ‹è¯•è„šæœ¬
â”‚       â”œâ”€â”€ test_bbox_refinement.py  # è¾¹ç•Œæ¡†å¾®è°ƒæµ‹è¯•
â”‚       â”œâ”€â”€ test_file_organization.py # æ–‡ä»¶ç»„ç»‡æµ‹è¯•
â”‚       â””â”€â”€ test_remoteclip.py       # RemoteCLIPæµ‹è¯•
â”‚
â”œâ”€â”€ outputs/                 # è¾“å‡ºæ–‡ä»¶
â”‚   â”œâ”€â”€ detection_results/   # æ£€æµ‹ç»“æœå›¾åƒ
â”‚   â”œâ”€â”€ visualizations/      # å¯è§†åŒ–ç»“æœ
â”‚   â””â”€â”€ evaluation_tables/   # è¯„ä¼°è¡¨æ ¼
â”‚
â””â”€â”€ docs/                    # æ–‡æ¡£è¯´æ˜
    â”œâ”€â”€ å®éªŒç»“æ„è¯´æ˜.md      # æœ¬æ–‡æ¡£
    â””â”€â”€ æ–‡ä»¶é‡æ–°ç»„ç»‡å®Œæˆæ€»ç»“.md # ç»„ç»‡æ€»ç»“
```

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. å¿«é€Ÿå¼€å§‹ï¼ˆæ¨èï¼‰
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œå¿«é€Ÿå¼€å§‹è„šæœ¬
./å¿«é€Ÿå¼€å§‹å®éªŒ.sh
```

### 2. è¿è¡Œå®Œæ•´æµæ°´çº¿
```bash
python experiment1/inference/inference_engine.py --image assets/airport.jpg --pipeline full
```

### 3. è¿è¡Œå•ä¸ªStage
```bash
# Stage1: æ•°æ®é¢„å¤„ç†å’Œå€™é€‰æ¡†ç”Ÿæˆ
python experiment1/inference/inference_engine.py --image assets/airport.jpg --pipeline stage1

# Stage2: ç›®æ ‡æ£€æµ‹å’Œä¼˜åŒ–
python experiment1/inference/inference_engine.py --image assets/airport.jpg --pipeline stage2
```

### 4. è¿è¡Œå•ä¸ªæ¨¡å—
```bash
# è¿è¡ŒåŒºåŸŸé‡‡æ ·æ¨¡å—
python experiment1/inference/inference_engine.py --image assets/airport.jpg --module sampling

# è¿è¡Œç›®æ ‡æ£€æµ‹æ¨¡å—
python experiment1/inference/inference_engine.py --image assets/airport.jpg --module target_detection

# è¿è¡ŒWordNetå¢å¼ºæ¨¡å—
python experiment1/inference/inference_engine.py --image assets/airport.jpg --module wordnet_enhancement

# è¿è¡Œè¾¹ç•Œæ¡†å¾®è°ƒæ¨¡å—
python experiment1/inference/inference_engine.py --image assets/airport.jpg --module bbox_refinement
```

### 5. è¿è¡Œå®éªŒè„šæœ¬
```bash
# æµ‹è¯•è¾¹ç•Œæ¡†å¾®è°ƒ
python experiment1/scripts/experiments/test_bbox_refinement.py

# æµ‹è¯•æ–‡ä»¶ç»„ç»‡
python experiment1/scripts/experiments/test_file_organization.py

# æµ‹è¯•RemoteCLIP
python experiment1/scripts/experiments/test_remoteclip.py
```

## ğŸ“‹ æ¨¡å—åŠŸèƒ½è¯´æ˜

### Stage1 æ¨¡å—
- **data_loader.py**: é¥æ„Ÿæ•°æ®åŠ è½½å’Œé¢„å¤„ç†
- **sampling.py**: å¤šç§åŒºåŸŸé‡‡æ ·ç­–ç•¥ï¼ˆåˆ†å±‚ã€é‡‘å­—å¡”ã€å¤šé˜ˆå€¼æ˜¾è‘—æ€§ï¼‰
- **proposal_generator.py**: ä»åŒºåŸŸç”Ÿæˆå€™é€‰æ¡†
- **proposal_classifier.py**: å€™é€‰æ¡†åˆ†ç±»
- **visualize_regions.py**: åŒºåŸŸå¯è§†åŒ–
- **retrieval.py**: å›¾åƒæ£€ç´¢åŠŸèƒ½

### Stage2 æ¨¡å—
- **target_detection.py**: ç›®æ ‡æ£€æµ‹ä¸»åŠŸèƒ½ï¼ˆå¯¹æ¯”å­¦ä¹ æ£€æµ‹ï¼‰
- **wordnet_vocabulary.py**: WordNetè¯æ±‡è¡¨ï¼ˆ100ä¸ªåŸºç¡€ç±»åˆ«ï¼‰
- **wordnet_enhancer.py**: WordNetè¯æ±‡å¢å¼ºå™¨ï¼ˆåŒä¹‰è¯ã€æ‰©å±•è¯ã€å±‚æ¬¡ç»“æ„ï¼‰
- **bbox_refinement.py**: è¾¹ç•Œæ¡†å¾®è°ƒï¼ˆä½ç½®ã€å°ºåº¦ã€è¾¹ç•Œï¼‰
- **proposal_scorer.py**: å€™é€‰æ¡†æ‰“åˆ†ï¼ˆåˆ†ç±»ã€å¯¹æ¯”ã€ç»¼åˆå¾—åˆ†ï¼‰
- **unseen_detection_pipeline.py**: æœªè§ç›®æ ‡æ£€æµ‹æµæ°´çº¿

### æ¨ç†æ¨¡å—
- **inference_engine.py**: ç»Ÿä¸€æ¨ç†æ¥å£ï¼ˆæ”¯æŒå®Œæ•´æµæ°´çº¿ã€å•Stageã€å•æ¨¡å—ï¼‰
- **model_loader.py**: æ¨¡å‹åŠ è½½ç®¡ç†ï¼ˆRemoteCLIPæ¨¡å‹ï¼‰
- **output_manager.py**: è¾“å‡ºæ–‡ä»¶ç®¡ç†ï¼ˆè‡ªåŠ¨è·¯å¾„ç”Ÿæˆï¼‰

## ğŸ”§ æŠ€æœ¯ç‰¹ç‚¹

1. **æ¨¡å—åŒ–è®¾è®¡**: æ¯ä¸ªåŠŸèƒ½ç‹¬ç«‹æˆæ¨¡å—ï¼Œä¾¿äºæµ‹è¯•å’Œæ‰©å±•
2. **ç»Ÿä¸€æ¥å£**: é€šè¿‡inference_engine.pyæä¾›ç»Ÿä¸€çš„è°ƒç”¨æ¥å£
3. **çµæ´»é…ç½®**: æ”¯æŒä¸åŒæ¨¡å‹ã€ä¸åŒå‚æ•°çš„å®éªŒé…ç½®
4. **å®Œæ•´æµæ°´çº¿**: æ”¯æŒä»æ•°æ®åŠ è½½åˆ°æœ€ç»ˆæ£€æµ‹çš„å®Œæ•´æµç¨‹
5. **å®éªŒå‹å¥½**: ä¾¿äºè¿›è¡Œä¸åŒæ–¹æ³•çš„å¯¹æ¯”å®éªŒ
6. **è¾“å‡ºç®¡ç†**: è‡ªåŠ¨ç®¡ç†æ‰€æœ‰è¾“å‡ºæ–‡ä»¶çš„ä½ç½®

## ğŸ“ˆ å®éªŒæµç¨‹

### Stage1: æ•°æ®é¢„å¤„ç†å’Œå€™é€‰æ¡†ç”Ÿæˆ
1. **æ•°æ®åŠ è½½** â†’ åŠ è½½é¥æ„Ÿå›¾åƒæ•°æ®
2. **åŒºåŸŸé‡‡æ ·** â†’ ä½¿ç”¨ä¸åŒç­–ç•¥é‡‡æ ·æ„Ÿå…´è¶£åŒºåŸŸ
3. **å€™é€‰æ¡†ç”Ÿæˆ** â†’ ä»åŒºåŸŸç”Ÿæˆç›®æ ‡å€™é€‰æ¡†
4. **å€™é€‰æ¡†åˆ†ç±»** â†’ å¯¹å€™é€‰æ¡†è¿›è¡Œåˆ†ç±»

### Stage2: ç›®æ ‡æ£€æµ‹å’Œä¼˜åŒ–
5. **å€™é€‰æ¡†æ‰“åˆ†** â†’ å¯¹å€™é€‰æ¡†è¿›è¡Œè´¨é‡è¯„åˆ†
6. **ç›®æ ‡æ£€æµ‹** â†’ æ£€æµ‹ç‰¹å®šç›®æ ‡ç±»åˆ«
7. **WordNetå¢å¼º** â†’ ä½¿ç”¨è¯æ±‡å¢å¼ºæé«˜æ£€æµ‹æ•ˆæœ
8. **è¾¹ç•Œæ¡†å¾®è°ƒ** â†’ ä¼˜åŒ–æ£€æµ‹æ¡†çš„ä½ç½®å’Œå¤§å°

## ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

- **æ¸…æ™°çš„ç»„ç»‡ç»“æ„**: æ‰€æœ‰å®éªŒæ–‡ä»¶é›†ä¸­åœ¨experiment1æ–‡ä»¶å¤¹
- **ä¾¿äºæ‰©å±•**: å¯ä»¥è½»æ¾æ·»åŠ experiment2ã€experiment3ç­‰å…¶ä»–æ–¹æ³•
- **å®éªŒå‹å¥½**: æ”¯æŒä¸åŒæ–¹æ³•çš„å¯¹æ¯”å®éªŒ
- **ç»Ÿä¸€ç®¡ç†**: é€šè¿‡æ¨ç†å¼•æ“ç»Ÿä¸€ç®¡ç†æ‰€æœ‰åŠŸèƒ½
- **è¾“å‡ºéš”ç¦»**: æ‰€æœ‰è¾“å‡ºæ–‡ä»¶ä¿å­˜åœ¨experiment1/outputsä¸­

## ğŸ“Š è¾“å‡ºæ–‡ä»¶è¯´æ˜

### detection_results/
å­˜æ”¾æ£€æµ‹ç»“æœå›¾åƒï¼ŒåŒ…æ‹¬ï¼š
- ç›®æ ‡æ£€æµ‹æ¡†é€‰ç»“æœ
- å¤šç›®æ ‡æ£€æµ‹ç»“æœ
- ä¸åŒæ¨¡å‹çš„æ£€æµ‹å¯¹æ¯”

### visualizations/
å­˜æ”¾å¯è§†åŒ–ç»“æœï¼ŒåŒ…æ‹¬ï¼š
- åŒºåŸŸé‡‡æ ·å¯è§†åŒ–
- å€™é€‰æ¡†åˆ†å¸ƒå¯è§†åŒ–
- æ£€æµ‹è¿‡ç¨‹å¯è§†åŒ–

### evaluation_tables/
å­˜æ”¾è¯„ä¼°è¡¨æ ¼ï¼ŒåŒ…æ‹¬ï¼š
- ä¸åŒæ–¹æ³•çš„æ€§èƒ½å¯¹æ¯”è¡¨
- å‚æ•°å½±å“åˆ†æè¡¨
- å®éªŒç»“æœæ±‡æ€»è¡¨

## ğŸš€ å¿«é€Ÿå®éªŒç¤ºä¾‹

### ç¤ºä¾‹1: èˆ°èˆ¹æ£€æµ‹
```bash
python experiment1/stage2/target_detection.py \
  --image datasets/ship.jpg \
  --target ship \
  --model RN50 \
  --strategy multi_threshold_saliency
```

### ç¤ºä¾‹2: é£æœºæ£€æµ‹
```bash
python experiment1/stage2/target_detection.py \
  --image assets/airport.jpg \
  --target airplane \
  --model RN50
```

### ç¤ºä¾‹3: æœªè§ç›®æ ‡æ£€æµ‹
```bash
python experiment1/stage2/unseen_detection_pipeline.py \
  --image test.jpg \
  --target "wind turbine" \
  --num-expansion 10
```

## ğŸ“š æ–‡æ¡£å¯¼èˆª

- **å®éªŒç»“æ„è¯´æ˜.md**: æœ¬æ–‡æ¡£ï¼Œä»‹ç»å®éªŒç»„ç»‡ç»“æ„
- **æ–‡ä»¶é‡æ–°ç»„ç»‡å®Œæˆæ€»ç»“.md**: æ–‡ä»¶é‡æ–°ç»„ç»‡çš„è¯¦ç»†æ€»ç»“

## ğŸ”„ æ·»åŠ æ–°æ–¹æ³•

å¦‚æœè¦æ·»åŠ å…¶ä»–æ£€æµ‹æ–¹æ³•ï¼Œå¯ä»¥ï¼š

1. åˆ›å»ºæ–°çš„å®éªŒæ–‡ä»¶å¤¹ï¼š`experiment2/`ã€`experiment3/`ç­‰
2. å¤åˆ¶experiment1çš„ç»“æ„
3. ä¿®æ”¹ç›¸åº”çš„æ¨¡å—å®ç°
4. ä½¿ç”¨ç›¸åŒçš„æ¨ç†å¼•æ“æ¥å£

è¿™æ ·å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œä¸åŒæ–¹æ³•çš„å¯¹æ¯”å®éªŒï¼

## ğŸ’¡ æç¤º

- æ‰€æœ‰å®éªŒæ–‡ä»¶éƒ½åœ¨ `experiment1/` æ–‡ä»¶å¤¹ä¸­
- è¿è¡Œè„šæœ¬å‰è¯·ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•
- è¾“å‡ºæ–‡ä»¶ä¼šè‡ªåŠ¨ä¿å­˜åˆ° `experiment1/outputs/` å¯¹åº”çš„å­æ–‡ä»¶å¤¹
- ä½¿ç”¨ `./å¿«é€Ÿå¼€å§‹å®éªŒ.sh` å¯ä»¥äº¤äº’å¼è¿è¡Œå®éªŒ